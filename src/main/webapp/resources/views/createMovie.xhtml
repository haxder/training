<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:tvt="https://github.com/luvina-thinhtv">
<h:head>
	<h:outputStylesheet library="css" name="bootstrap.css"/>
	<h:outputScript library="scripts" name="jquery-1.10.2.js"/>
	<h:outputScript library="scripts" name="jquery-ui.js"/>
	<h:outputScript library="scripts" name="bootstrap.js"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>this is movies details</title>
</h:head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/training">MVC Movies</a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li><a href="/training">Home</a></li>
					<li><a href="/Movies/About">About</a></li>
					<li><a href="/Movies/Movies">Movies</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="container body-content">
		<h2>Details</h2>
		<h:form enctype="multipart/form-data" id="form">
		<f:event listener="#{movieController.createMovieInit}" type="preRenderComponent" />
			<p:outputPanel id="createMovie">
				<div>
					<h4>Movie</h4>
					<hr />
					<p:outputPanel>
						<p:messages id="messages" closable="true" showIcon="false"/>
						<p:focus context="createMovie"/>
						<tvt:formMultiValidator forIds="input_genre, input_title" validator="formValidator"/>
						<table>
							<tr>
								<td>
									<p:graphicImage
											library="image" name="#{movieController.createMovie.image == null ? 'noImage.png' : movieController.createMovie.image}"
											alt="#{movieController.createMovie.image == null ? 'No Image' : movieController.createMovie.image}" style="width : 240px; height : 355px"/>
									<h:inputFile value="#{movieController.imgfileUpload}" onchange="previewFile()"/>
								</td>
								<td>
									<dl class="dl-horizontal">
										<dt><p:outputLabel value="Genre" for="input_genre" indicateRequired="true"/></dt>
										<dd>
											<p:inputText id ="input_genre" value="#{movieController.createMovie.genre}" required="true" label="Genre"/>
										</dd>
										<dt><p:outputLabel value="Title" for="input_title" indicateRequired="true"/></dt>
										<dd>
											<p:inputText id="input_title" value="#{movieController.createMovie.title}"  required="true" label="Title"/>
										</dd>
										<dt>Release Date</dt>
										<dd>
											<p:calendar
												value="#{movieController.createMovie.releaseDate}" pattern="yyyy-MM-dd" navigator="true" label="Release Date"/>
										</dd>
										<dt>Price</dt>
										<dd>
											<p:inputText id="input_price" value="#{movieController.createMovie.price}" label="Price">
												<f:validateRegex pattern="[1-9]([0-9])*"/>
												<f:validateLength maximum="2"/>
											</p:inputText>
										</dd>
										<dt>Rate</dt>
										<dd>
											<p:rating value="#{movieController.createMovie.rate}" />
										</dd>
										<dt/>
										<dd><p:commandButton value="Save" update="createMovie" action="#{movieController.createMovieAction}" ajax="false"/></dd>
									</dl>
								</td>
							</tr>
						</table>
					</p:outputPanel>
				</div>
			</p:outputPanel>
		</h:form>
		<hr />
		<footer>
		<p>&copy; 2018 - Training ASP.Net with VB.NET by ThinhTV</p>
		</footer>
	</div>
</body>
<script>
        function previewFile() {
            var preview = document.querySelector('img');
            var file = document.querySelector('input[type=file]').files[0];
            var reader = new FileReader();

            reader.addEventListener("load", function () {
                preview.src = reader.result;
            }, false);

            if (file) {
                reader.readAsDataURL(file);
            }
        };
</script>
</html>